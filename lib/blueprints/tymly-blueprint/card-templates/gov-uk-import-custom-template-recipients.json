{
  "$schema": "http://adaptivecards.io/schemas/adaptive-card.json",
  "version": "1.0",
  "type": "AdaptiveCard",
  "body": [
    {
      "type": "Container",
      "color": "accent",
      "items": [
        {
          "type": "TextBlock",
          "size": "medium",
          "weight": "bolder",
          "text": "Custom Message Template Recipient"
        }
      ]
    },
    {
      "id": "mailUpload",
      "type": "Input.FileUpload",
      "title": "Select a file",
      "showWhen": "data.messageType === 'mail'",
      "onUploadEndpoint": {
        "name": "tymly_processGovUkCustomTemplateRecipients_1_0"
      },
      "additionalFields": {
        "upload": true,
        "messageType": "mail"
      },
      "accept": [
        ".csv"
      ]
    },
    {
      "id": "smsUpload",
      "type": "Input.FileUpload",
      "title": "Select a file",
      "showWhen": "data.messageType === 'sms'",
      "onUploadEndpoint": {
        "name": "tymly_processGovUkCustomTemplateRecipients_1_0"
      },
      "autoUpload": true,
      "additionalFields": {
        "upload": true,
        "messageType": "sms"
      },
      "accept": [
        ".csv"
      ]
    },
    {
      "type": "Container",
      "spacing": "none",
      "color": "warning",
      "showWhen": "data.importLog && data.importLog.rejected.length > 0",
      "items": [
        {
          "type": "TextBlock",
          "text": "The recipients list you uploaded contains some invalid entries",
          "spacing": "none"
        },
        {
          "id": "rejectedList",
          "type": "List",
          "arrayPath": "data.importLog.rejected",
          "templates": {
            "label": "{{ item }}"
          }
        }
      ]
    },
    {
      "type": "Container",
      "spacing": "none",
      "color": "good",
      "showWhen": "data.importLog && data.importLog.rejected.length === 0",
      "items": [
        {
          "type": "TextBlock",
          "text": "All recipients successfully loaded",
          "spacing": "none"
        }
      ]
    }
  ],
  "actions": [
    {
      "type": "Action.Cancel",
      "title": "Cancel"
    },
    {
      "title": "Submit",
      "type": "Action.Submit"
    }
  ],
  "templateMeta": {
    "name": "import-gov-uk-view-custom-template-recipients",
    "title": "Custom Message Template Recipient",
    "category": "govUkNotify"
  }
}
